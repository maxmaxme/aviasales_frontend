(this.webpackJsonpaviasales_frontend=this.webpackJsonpaviasales_frontend||[]).push([[0],[,,,,,,,,,,,,,,function(t,e,n){},function(t,e,n){},,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var c,s=n(1),i=n.n(s),r=n(7),a=n.n(r),o=(n(14),n(15),function(t,e){return e[(t=Math.abs(t))%100>4&&t%100<20?2:[2,0,1,1,1,2][t%10<5?t%10:5]]}),u=n(0),d=function(t){return t<10?"0".concat(t):t},l=function(t){var e=Math.floor(t/1440),n=Math.floor((t-1440*e)/60),c=Math.round(t%60);return e?"".concat(e,"\u0434 ").concat(n,"\u0447 ").concat(d(c),"\u043c"):"".concat(n,"\u0447 ").concat(d(c),"\u043c")},j=function(t){var e,n=t.segment,c=new Date(n.date),s="".concat(d(c.getUTCHours()),":").concat(d(c.getUTCMinutes())),i=new Date(c.getTime()+6e4*n.duration),r="".concat(d(i.getUTCHours()),":").concat(d(i.getUTCMinutes()));return Object(u.jsxs)("div",{className:"TicketSegment",children:[Object(u.jsxs)("div",{className:"TicketSegment__data",children:[Object(u.jsxs)("div",{className:"TicketSegment__dataHeader",children:[n.origin," \u2013 ",n.destination]}),Object(u.jsxs)("div",{className:"TicketSegment__dataText",children:[s," \u2013 ",r]})]}),Object(u.jsxs)("div",{className:"TicketSegment__data",children:[Object(u.jsx)("div",{className:"TicketSegment__dataHeader",children:"\u0432 \u043f\u0443\u0442\u0438"}),Object(u.jsx)("div",{className:"TicketSegment__dataText",children:l(n.duration)})]}),Object(u.jsxs)("div",{className:"TicketSegment__data",children:[Object(u.jsx)("div",{className:"TicketSegment__dataHeader",children:(e=n.stops.length,e?o(e,["%s \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430","%s \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438","%s \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"]).replace("%s",e.toString()):"\u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a")}),Object(u.jsx)("div",{className:"TicketSegment__dataText",children:n.stops.join(", ")})]})]})},b=(n(17),function(t){var e,n=t.ticket;return Object(u.jsxs)("div",{className:"Ticket",children:[Object(u.jsxs)("div",{className:"Ticket__header",children:[Object(u.jsx)("div",{className:"Ticket__price",children:(e=n.price,new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}).format(e))}),Object(u.jsx)("div",{className:"Ticket__carrierLogo",children:Object(u.jsx)("img",{src:"//pics.avs.io/99/36/".concat(n.carrier,".png"),alt:""})})]}),Object(u.jsx)("div",{className:"Ticket__segments",children:n.segments.map((function(t,e){return Object(u.jsx)("div",{className:"Ticket__segment",children:Object(u.jsx)(j,{segment:t})},e)}))})]})}),h=(n(18),n(19),n(9)),f=n(2),p=n(6);!function(t){t.AddTickets="ADD_TICKETS",t.SetSort="SET_SORT",t.AddStopCount="ADD_STOP_COUNT",t.RemoveStopCount="REMOVE_STOP_COUNT",t.SetStopsCount="SET_STOPS_COUNT",t.LoadMoreTickets="LOAD_MORE_TICKETS",t.SetLoading="SET_LOADING"}(c||(c={}));var m=function(t,e){switch(e.type){case c.AddTickets:return t.concat.apply(t,Object(p.a)(e.payload));default:return t}},O=function(t,e){switch(e.type){case c.SetStopsCount:return Object(f.a)(Object(f.a)({},t),{},{stopsCount:e.payload});case c.AddStopCount:return Object(f.a)(Object(f.a)({},t),{},{stopsCount:t.stopsCount.includes(e.payload)?t.stopsCount:[].concat(Object(p.a)(t.stopsCount),[e.payload])});case c.RemoveStopCount:return Object(f.a)(Object(f.a)({},t),{},{stopsCount:t.stopsCount.filter((function(t){return t!==e.payload}))});case c.LoadMoreTickets:return Object(f.a)(Object(f.a)({},t),{},{ticketsLimit:t.ticketsLimit+5});default:return t}},x=function(t,e){switch(e.type){case c.SetSort:return e.payload;default:return t}},_=function(t,e){switch(e.type){case c.SetLoading:return e.payload;default:return t}},v=0,k=1,g=2,T={loading:!0,tickets:[],sort:g,filters:{ticketsLimit:5,stopsCount:[]}},S=Object(s.createContext)({state:T,dispatch:function(){return null}}),C=function(t,e){var n=t.tickets,c=t.sort,s=t.filters,i=t.loading;return{loading:_(i,e),filters:O(s,e),sort:x(c,e),tickets:m(n,e)}},N=function(t){var e=t.children,n=Object(s.useReducer)(C,T),c=Object(h.a)(n,2),i=c[0],r=c[1];return Object(u.jsx)(S.Provider,{value:{state:i,dispatch:r},children:e})},y=function(){var t=Object(s.useContext)(S).dispatch;return Object(u.jsx)("button",{className:"ShowMoreButton",onClick:function(){return t({type:c.LoadMoreTickets})},children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0435 5 \u0431\u0438\u043b\u0435\u0442\u043e\u0432!"})},w=(n(20),function(){return Object(u.jsx)("svg",{className:"Spinner",xmlns:"http://www.w3.org/2000/svg",viewBox:"-20 -20 40 40",children:Object(u.jsx)("circle",{r:"16",strokeWidth:"3"})})}),M=function(){var t=Object(s.useContext)(S).state,e=t.loading,n=t.tickets,c=t.filters,i=c.stopsCount,r=c.ticketsLimit,a=t.sort,o=n.filter((function(t){if(i.length){var e=t.segments.map((function(t){return t.stops.length})).reduce((function(t,e){return t+e}),0);return i.includes(e)}return!0})).sort((function(t,e){switch(a){case k:return t.segments.map((function(t){return t.duration})).reduce((function(t,e){return t+e}),0)-e.segments.map((function(t){return t.duration})).reduce((function(t,e){return t+e}),0);case v:return t.price-e.price;case g:default:return 1}}));return Object(u.jsxs)("div",{className:"Tickets",children:[Object(u.jsx)("div",{className:"Tickets__list",children:o.slice(0,r).map((function(t,e){return Object(u.jsx)("div",{className:"Tickets__ticket",children:Object(u.jsx)(b,{ticket:t})},e)}))}),o.length>r&&Object(u.jsx)("div",{className:"Tickets__showMoreButton",children:Object(u.jsx)(y,{})}),e&&Object(u.jsx)("div",{className:"Tickets__spinner",children:Object(u.jsx)(w,{})})]})},L=(n(21),function(t){var e=t.title,n=t.checked,c=t.onChange;return Object(u.jsxs)("label",{className:"Checkbox",children:[Object(u.jsx)("input",{className:"Checkbox__input",type:"checkbox",checked:n,onChange:c}),Object(u.jsx)("span",{className:"Checkbox__box"}),e]})}),A=(n(22),function(t){return t?o(t,["%s \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430","%s \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438","%s \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"]).replace("%s",t.toString()):"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),E=function(){var t=Object(s.useContext)(S),e=t.state,n=e.tickets,i=e.filters.stopsCount,r=t.dispatch,a=n.map((function(t){return t.segments.map((function(t){return t.stops.length})).reduce((function(t,e){return t+e}),0)})).filter((function(t,e,n){return n.indexOf(t)===e})).sort(),o=function(t){return function(e){r({type:e.target.checked?c.AddStopCount:c.RemoveStopCount,payload:t})}};return Object(u.jsxs)("div",{className:"Filter",children:[Object(u.jsx)("div",{className:"Filter__header",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),Object(u.jsx)("label",{className:"Filter__item",children:Object(u.jsx)(L,{checked:!i.length,onChange:function(){return r({type:c.SetStopsCount,payload:[]})},title:"\u0412\u0441\u0435"})}),a.map((function(t){return Object(u.jsx)("label",{className:"Filter__item",children:Object(u.jsx)(L,{checked:i.includes(t),onChange:o(t),title:A(t)})},t)}))]})},D=n(8),R=n.n(D),U=(n(23),function(t){var e=t.title,n=t.selected,c=t.onSelect;return Object(u.jsx)("button",{className:R()("Tabs__tab",{"Tabs__tab--selected":n}),onClick:c,children:e})}),I=function(){var t=Object(s.useContext)(S),e=t.state.sort,n=t.dispatch,i=[{id:v,title:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0451\u0432\u044b\u0439"},{id:k,title:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439"},{id:g,title:"\u041e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439"}];return Object(u.jsx)("div",{className:"Tabs",children:i.map((function(t){return Object(u.jsx)(U,{title:t.title,selected:t.id===e,onSelect:(s=t.id,function(){return n({type:c.SetSort,payload:s})})},t.id);var s}))})},F=(n(24),function(){return Object(u.jsx)("div",{className:"Header"})}),H=(n(25),function t(e,n){return fetch("https://front-test.beta.aviasales.ru/tickets?searchId="+e).then((function(t){return t.ok?t.json():{tickets:[],stop:!1}})).then((function(c){var s=c.tickets,i=c.stop;return n(s),i?Promise.resolve():t(e,n)}))}),B=function(){var t=Object(s.useContext)(S).dispatch;return Object(s.useEffect)((function(){fetch("https://front-test.beta.aviasales.ru/search").then((function(t){return t.json()})).then((function(t){return t.searchId})).then((function(e){return H(e,(function(e){t({type:c.AddTickets,payload:e})}))})).then((function(){t({type:c.SetLoading,payload:!1})}))}),[]),Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)(F,{}),Object(u.jsxs)("div",{className:"App__content",children:[Object(u.jsx)(E,{}),Object(u.jsxs)("div",{children:[Object(u.jsx)(I,{}),Object(u.jsx)(M,{})]})]})]})};a.a.render(Object(u.jsx)(i.a.StrictMode,{children:Object(u.jsx)(N,{children:Object(u.jsx)(B,{})})}),document.getElementById("root"))}],[[26,1,2]]]);
//# sourceMappingURL=main.1f749851.chunk.js.map